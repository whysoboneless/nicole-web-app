{% extends "modern_base.html" %}

{% block title %}Settings - Nicole AI{% endblock %}

{% block page_title %}Settings{% endblock %}
{% block page_description %}Manage your account preferences and automation settings{% endblock %}

{% block content %}
<div x-data="settingsPage()">
    <!-- Tab Navigation -->
    <div class="glass-effect rounded-xl p-1 mb-8">
        <div class="flex space-x-1">
            <button @click="currentTab = 'profile'" 
                    :class="currentTab === 'profile' ? 'bg-white shadow-sm' : 'hover:bg-gray-50'"
                    class="flex-1 py-3 px-4 text-center rounded-lg font-medium transition-colors">
                ðŸ‘¤ Profile
            </button>
            <button @click="currentTab = 'automation'" 
                    :class="currentTab === 'automation' ? 'bg-white shadow-sm' : 'hover:bg-gray-50'"
                    class="flex-1 py-3 px-4 text-center rounded-lg font-medium transition-colors">
                ðŸ¤– Automation
            </button>
            <button @click="currentTab = 'billing'" 
                    :class="currentTab === 'billing' ? 'bg-white shadow-sm' : 'hover:bg-gray-50'"
                    class="flex-1 py-3 px-4 text-center rounded-lg font-medium transition-colors">
                ðŸ’³ Billing
            </button>
            <button @click="currentTab = 'notifications'" 
                    :class="currentTab === 'notifications' ? 'bg-white shadow-sm' : 'hover:bg-gray-50'"
                    class="flex-1 py-3 px-4 text-center rounded-lg font-medium transition-colors">
                ðŸ”” Notifications
            </button>
            <button @click="currentTab = 'security'" 
                    :class="currentTab === 'security' ? 'bg-white shadow-sm' : 'hover:bg-gray-50'"
                    class="flex-1 py-3 px-4 text-center rounded-lg font-medium transition-colors">
                ðŸ”’ Security
            </button>
        </div>
    </div>

    <!-- Profile Settings -->
    <div x-show="currentTab === 'profile'">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Profile Info -->
            <div class="lg:col-span-2">
                <div class="glass-effect rounded-xl p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-6">Profile Information</h3>
                    <form @submit.prevent="saveProfile()">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                                <input type="text" x-model="profile.firstName" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                                <input type="text" x-model="profile.lastName" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                            <input type="email" x-model="profile.email" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Timezone</label>
                            <select x-model="profile.timezone" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="America/New_York">Eastern Time (EST)</option>
                                <option value="America/Chicago">Central Time (CST)</option>
                                <option value="America/Denver">Mountain Time (MST)</option>
                                <option value="America/Los_Angeles">Pacific Time (PST)</option>
                                <option value="Europe/London">GMT</option>
                                <option value="Europe/Paris">Central European Time</option>
                            </select>
                        </div>
                        
                        <button type="submit" 
                                class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors">
                            Save Changes
                        </button>
                    </form>
                </div>
            </div>

            <!-- Profile Picture -->
            <div class="lg:col-span-1">
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">Profile Picture</h3>
                    <div class="text-center">
                        <div class="w-24 h-24 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl font-bold">{{ current_user.username[0] if current_user.username else 'U' }}</span>
                        </div>
                        <button @click="uploadPicture()" 
                                class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors">
                            Change Picture
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Automation Settings -->
    <div x-show="currentTab === 'automation'">
        <div class="space-y-6">
            <!-- Default Settings -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Default Automation Settings</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Default Video Duration</label>
                        <select x-model="automation.defaultDuration" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="30min">30 minutes</option>
                            <option value="1h">1 hour</option>
                            <option value="1h30m">1.5 hours</option>
                            <option value="2h">2 hours</option>
                            <option value="8h">8 hours</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Default Voice</label>
                        <select x-model="automation.defaultVoice" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="af_nicole">Nicole (Female)</option>
                            <option value="am_adam">Adam (Male)</option>
                            <option value="af_sarah">Sarah (Female)</option>
                            <option value="am_david">David (Male)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Default Visual Style</label>
                        <select x-model="automation.defaultVisualStyle" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="black_rain">Black Rain</option>
                            <option value="ai_images">AI Images</option>
                            <option value="ai_videos">AI Videos</option>
                            <option value="ocean">Ocean</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Default Upload Schedule</label>
                        <select x-model="automation.defaultSchedule" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="daily">Daily</option>
                            <option value="double">Twice Daily</option>
                            <option value="triple">Three Times Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="bi-weekly">Bi-weekly</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Quality Settings -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Quality & Performance</h3>
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-medium text-gray-900">High Quality Thumbnails</h4>
                            <p class="text-sm text-gray-600">Generate thumbnails at maximum resolution</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" x-model="automation.highQualityThumbnails" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-medium text-gray-900">Auto-Optimize Scripts</h4>
                            <p class="text-sm text-gray-600">Automatically improve scripts using AI analysis</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" x-model="automation.autoOptimizeScripts" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-medium text-gray-900">Backup Uploads</h4>
                            <p class="text-sm text-gray-600">Create backup uploads if primary fails</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" x-model="automation.backupUploads" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Billing Settings -->
    <div x-show="currentTab === 'billing'">
        <div class="space-y-6">
            <!-- Current Plan -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Current Plan</h3>
                <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6 mb-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="text-xl font-bold text-gray-900">Pro Plan</h4>
                            <p class="text-gray-600">Unlimited channels, advanced features</p>
                        </div>
                        <div class="text-right">
                            <p class="text-2xl font-bold text-indigo-600">$97/month</p>
                            <p class="text-sm text-gray-600">Billed monthly</p>
                        </div>
                    </div>
                </div>
                
                <div class="flex space-x-4">
                    <button @click="upgradePlan()" 
                            class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-2 rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all">
                        Upgrade to Enterprise
                    </button>
                    <button @click="manageBilling()" 
                            class="bg-gray-100 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-200 transition-colors">
                        Manage Billing
                    </button>
                </div>
            </div>

            <!-- Payment Method -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Payment Method</h3>
                <div class="flex items-center space-x-4 mb-4">
                    <div class="w-12 h-8 bg-blue-600 rounded flex items-center justify-center">
                        <span class="text-white text-xs font-bold">VISA</span>
                    </div>
                    <div>
                        <p class="font-medium text-gray-900">â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ 4242</p>
                        <p class="text-sm text-gray-600">Expires 12/25</p>
                    </div>
                </div>
                <button @click="updatePaymentMethod()" 
                        class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors">
                    Update Payment Method
                </button>
            </div>

            <!-- Usage & Limits -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Usage This Month</h3>
                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-sm text-gray-600">Videos Generated</span>
                            <span class="text-sm font-medium">127 / Unlimited</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 65%"></div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-sm text-gray-600">Storage Used</span>
                            <span class="text-sm font-medium">847 GB / 1 TB</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-yellow-500 h-2 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-sm text-gray-600">API Calls</span>
                            <span class="text-sm font-medium">45,230 / Unlimited</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-blue-500 h-2 rounded-full" style="width: 40%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Settings -->
    <div x-show="currentTab === 'notifications'">
        <div class="glass-effect rounded-xl p-6">
            <h3 class="text-lg font-bold text-gray-900 mb-6">Notification Preferences</h3>
            <div class="space-y-6">
                <div>
                    <h4 class="font-medium text-gray-900 mb-4">Email Notifications</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700">Video upload completion</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="notifications.uploadCompletion" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700">Upload failures or errors</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="notifications.uploadErrors" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700">Weekly performance summary</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="notifications.weeklySummary" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700">Product updates and features</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="notifications.productUpdates" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-medium text-gray-900 mb-4">Browser Notifications</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700">Campaign status updates</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="notifications.campaignUpdates" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700">System maintenance alerts</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="notifications.maintenanceAlerts" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                            </label>
                        </div>
                    </div>
                        </div>
                    </div>
                </div>
            </div>
            
    <!-- Security Settings -->
    <div x-show="currentTab === 'security'">
        <div class="space-y-6">
            <!-- Password Change -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Change Password</h3>
                <form @submit.prevent="changePassword()">
                <div class="space-y-4">
                    <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Current Password</label>
                            <input type="password" x-model="security.currentPassword" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">New Password</label>
                            <input type="password" x-model="security.newPassword" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    
                    <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password</label>
                            <input type="password" x-model="security.confirmPassword" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        
                        <button type="submit" 
                                class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors">
                            Update Password
                        </button>
                    </div>
                </form>
            </div>

            <!-- Two-Factor Authentication -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Two-Factor Authentication</h3>
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h4 class="font-medium text-gray-900">Enable 2FA</h4>
                        <p class="text-sm text-gray-600">Add an extra layer of security to your account</p>
                    </div>
                    <button @click="setup2FA()" 
                            :class="security.twoFactorEnabled ? 'bg-green-600 hover:bg-green-700' : 'bg-indigo-600 hover:bg-indigo-700'"
                            class="text-white px-4 py-2 rounded-lg transition-colors" 
                            x-text="security.twoFactorEnabled ? 'Enabled' : 'Setup 2FA'">
                    </button>
                </div>
            </div>

            <!-- Active Sessions -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-6">Active Sessions</h3>
                <div class="space-y-4">
                    <template x-for="session in security.activeSessions" :key="session.id">
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                            <div>
                                <p class="font-medium text-gray-900" x-text="session.device"></p>
                                <p class="text-sm text-gray-600" x-text="session.location + ' â€¢ ' + session.lastActive"></p>
                            </div>
                            <button @click="revokeSession(session)" 
                                    x-show="!session.current"
                                    class="text-red-600 hover:text-red-800 text-sm font-medium">
                                Revoke
                            </button>
                            <span x-show="session.current" class="text-green-600 text-sm font-medium">Current</span>
                        </div>
                    </template>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
function settingsPage() {
    return {
        currentTab: 'profile',
        
        profile: {
            firstName: 'John',
            lastName: 'Doe',
            email: 'john@example.com',
            timezone: 'America/New_York'
        },
        
        automation: {
            defaultDuration: '30min',
            defaultVoice: 'af_nicole',
            defaultVisualStyle: 'black_rain',
            defaultSchedule: 'daily',
            highQualityThumbnails: true,
            autoOptimizeScripts: true,
            backupUploads: false
        },
        
        notifications: {
            uploadCompletion: true,
            uploadErrors: true,
            weeklySummary: true,
            productUpdates: false,
            campaignUpdates: true,
            maintenanceAlerts: true
        },
        
        security: {
            currentPassword: '',
            newPassword: '',
            confirmPassword: '',
            twoFactorEnabled: false,
            activeSessions: [
                { id: 1, device: 'Chrome on Windows', location: 'New York, US', lastActive: '2 minutes ago', current: true },
                { id: 2, device: 'Safari on iPhone', location: 'New York, US', lastActive: '1 hour ago', current: false },
                { id: 3, device: 'Firefox on MacOS', location: 'Los Angeles, US', lastActive: '2 days ago', current: false }
            ]
        },
        
        saveProfile() {
            alert('Profile updated successfully!');
        },
        
        uploadPicture() {
            alert('Picture upload functionality would be implemented here');
        },
        
        upgradePlan() {
            alert('Redirecting to upgrade page...');
        },
        
        manageBilling() {
            alert('Opening billing portal...');
        },
        
        updatePaymentMethod() {
            alert('Payment method update form would open here');
        },
        
        changePassword() {
            if (this.security.newPassword !== this.security.confirmPassword) {
                alert('New passwords do not match!');
                return;
            }
            alert('Password updated successfully!');
        },
        
        setup2FA() {
            if (this.security.twoFactorEnabled) {
                alert('2FA is already enabled');
            } else {
                alert('2FA setup wizard would open here');
                this.security.twoFactorEnabled = true;
            }
        },
        
        revokeSession(session) {
            this.security.activeSessions = this.security.activeSessions.filter(s => s.id !== session.id);
            alert(`Session revoked: ${session.device}`);
        }
    }
}
</script>
{% endblock %}