{% extends "modern_base.html" %}

{% block title %}Channel Analytics - Nicole AI{% endblock %}

{% block page_title %}Channel Analytics{% endblock %}
{% block page_description %}Deep insights into your YouTube channel performance and KPIs{% endblock %}

{% block content %}
<div x-data="analyticsPage()">
    <!-- Channel Selector -->
    <div class="glass-effect rounded-xl p-6 mb-8">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Channel Performance Dashboard</h3>
                <p class="text-gray-600">Monitor KPIs, revenue, and automation performance across all channels</p>
            </div>
            <div class="flex items-center space-x-3">
                <select x-model="selectedChannel" @change="updateAnalytics()" 
                        class="bg-white border border-gray-200 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="all">All Channels</option>
                    <option value="ch1">CryptoMaster Daily</option>
                    <option value="ch2">AI Tools Review</option>
                    <option value="ch3">Finance Genius</option>
                    <option value="ch4">Mindset Mastery</option>
                    <option value="ch5">Tech Trends Today</option>
                </select>
                <select x-model="timeRange" @change="updateAnalytics()"
                        class="bg-white border border-gray-200 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="7d">Last 7 days</option>
                    <option value="30d">Last 30 days</option>
                    <option value="90d">Last 90 days</option>
                    <option value="1y">Last year</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Key Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="glass-effect rounded-xl p-6 card-hover">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-medium text-gray-600">Total Revenue</h4>
                <span class="text-green-500 text-xl">ðŸ’°</span>
            </div>
            <p class="text-3xl font-bold text-gray-900" x-text="formatCurrency(metrics.revenue)">$8,920</p>
            <div class="flex items-center mt-2">
                <span :class="metrics.revenueChange >= 0 ? 'text-green-600' : 'text-red-600'" 
                      class="text-sm font-medium" x-text="(metrics.revenueChange >= 0 ? '+' : '') + metrics.revenueChange + '%'">+12.5%</span>
                <span class="text-gray-500 text-sm ml-1">vs last period</span>
            </div>
        </div>

        <div class="glass-effect rounded-xl p-6 card-hover">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-medium text-gray-600">Total Spend</h4>
                <span class="text-red-500 text-xl">ðŸ’¸</span>
            </div>
            <p class="text-3xl font-bold text-gray-900" x-text="formatCurrency(metrics.spend)">$2,450</p>
            <div class="flex items-center mt-2">
                <span :class="metrics.spendChange >= 0 ? 'text-red-600' : 'text-green-600'" 
                      class="text-sm font-medium" x-text="(metrics.spendChange >= 0 ? '+' : '') + metrics.spendChange + '%'">+8.2%</span>
                <span class="text-gray-500 text-sm ml-1">vs last period</span>
            </div>
        </div>

        <div class="glass-effect rounded-xl p-6 card-hover">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-medium text-gray-600">ROI</h4>
                <span class="text-purple-500 text-xl">ðŸ“ˆ</span>
            </div>
            <p class="text-3xl font-bold text-gray-900" x-text="metrics.roi + 'x'">3.6x</p>
            <div class="flex items-center mt-2">
                <span :class="metrics.roiChange >= 0 ? 'text-green-600' : 'text-red-600'" 
                      class="text-sm font-medium" x-text="(metrics.roiChange >= 0 ? '+' : '') + metrics.roiChange + '%'">+4.1%</span>
                <span class="text-gray-500 text-sm ml-1">vs last period</span>
            </div>
            </div>
            
        <div class="glass-effect rounded-xl p-6 card-hover">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-medium text-gray-600">Videos Published</h4>
                <span class="text-blue-500 text-xl">ðŸŽ¬</span>
            </div>
            <p class="text-3xl font-bold text-gray-900" x-text="metrics.videosPublished">113</p>
            <div class="flex items-center mt-2">
                <span :class="metrics.videosChange >= 0 ? 'text-green-600' : 'text-red-600'" 
                      class="text-sm font-medium" x-text="(metrics.videosChange >= 0 ? '+' : '') + metrics.videosChange + '%'">+15.3%</span>
                <span class="text-gray-500 text-sm ml-1">vs last period</span>
            </div>
        </div>
            </div>
            
    <!-- Charts Row -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- Revenue Trend -->
        <div class="glass-effect rounded-xl p-6">
            <h4 class="text-lg font-semibold text-gray-900 mb-4">Revenue Trend</h4>
            <div class="h-64 bg-gradient-to-br from-green-50 to-green-100 rounded-lg flex items-center justify-center">
                <div class="text-center">
                    <div class="text-4xl mb-2">ðŸ“Š</div>
                    <p class="text-gray-600">Revenue chart would display here</p>
                    <p class="text-sm text-gray-500 mt-1">Integration with analytics API pending</p>
                </div>
            </div>
            </div>
            
        <!-- Performance Metrics -->
        <div class="glass-effect rounded-xl p-6">
            <h4 class="text-lg font-semibold text-gray-900 mb-4">Performance Breakdown</h4>
            <div class="space-y-4">
                <template x-for="metric in performanceMetrics" :key="metric.name">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-3 h-3 rounded-full" :style="'background-color: ' + metric.color"></div>
                            <span class="text-sm font-medium text-gray-700" x-text="metric.name"></span>
                        </div>
                        <div class="text-right">
                            <span class="text-sm font-semibold text-gray-900" x-text="metric.value"></span>
                            <span :class="metric.change >= 0 ? 'text-green-600' : 'text-red-600'" 
                                  class="text-xs ml-2" x-text="(metric.change >= 0 ? '+' : '') + metric.change + '%'"></span>
                        </div>
                    </div>
                </template>
            </div>
            </div>
        </div>
        
    <!-- Channel Breakdown -->
    <div class="glass-effect rounded-xl p-6">
        <div class="flex items-center justify-between mb-6">
            <h4 class="text-lg font-semibold text-gray-900">Channel Performance Breakdown</h4>
            <button @click="exportData()" class="bg-indigo-100 text-indigo-700 px-4 py-2 rounded-lg hover:bg-indigo-200 transition-colors">
                ðŸ“¥ Export Data
            </button>
        </div>

        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-gray-200">
                        <th class="text-left py-3 px-4 font-medium text-gray-700">Channel</th>
                        <th class="text-left py-3 px-4 font-medium text-gray-700">Status</th>
                        <th class="text-left py-3 px-4 font-medium text-gray-700">Videos</th>
                        <th class="text-left py-3 px-4 font-medium text-gray-700">Revenue</th>
                        <th class="text-left py-3 px-4 font-medium text-gray-700">Spend</th>
                        <th class="text-left py-3 px-4 font-medium text-gray-700">ROI</th>
                        <th class="text-left py-3 px-4 font-medium text-gray-700">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="channel in channelBreakdown" :key="channel.id">
                        <tr class="border-b border-gray-100 hover:bg-gray-50">
                            <td class="py-4 px-4">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center">
                                        <span class="text-white text-sm font-bold" x-text="channel.name.charAt(0)"></span>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-900" x-text="channel.name"></p>
                                        <p class="text-sm text-gray-600" x-text="channel.subscribers"></p>
                                    </div>
                                </div>
                            </td>
                            <td class="py-4 px-4">
                                <span :class="channel.status === 'active' ? 'bg-green-100 text-green-700' : 
                                             channel.status === 'paused' ? 'bg-yellow-100 text-yellow-700' : 
                                             'bg-red-100 text-red-700'"
                                      class="px-2 py-1 rounded-full text-xs font-medium" x-text="channel.status"></span>
                            </td>
                            <td class="py-4 px-4 text-gray-900" x-text="channel.videos"></td>
                            <td class="py-4 px-4 font-semibold text-green-600" x-text="formatCurrency(channel.revenue)"></td>
                            <td class="py-4 px-4 font-semibold text-red-600" x-text="formatCurrency(channel.spend)"></td>
                            <td class="py-4 px-4 font-semibold" 
                                :class="channel.roi >= 2 ? 'text-green-600' : channel.roi >= 1 ? 'text-yellow-600' : 'text-red-600'"
                                x-text="channel.roi + 'x'"></td>
                            <td class="py-4 px-4">
                                <button @click="viewChannelDetails(channel)" 
                                        class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                                    View Details
                                </button>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
            </div>
        </div>
    </div>

<script>
function analyticsPage() {
    return {
        selectedChannel: 'all',
        timeRange: '30d',
        
        metrics: {
            revenue: 8920,
            revenueChange: 12.5,
            spend: 2450,
            spendChange: 8.2,
            roi: 3.6,
            roiChange: 4.1,
            videosPublished: 113,
            videosChange: 15.3
        },
        
        performanceMetrics: [
            { name: 'Views', value: '2.4M', change: 18.2, color: '#3B82F6' },
            { name: 'Avg. Watch Time', value: '4:32', change: 12.1, color: '#10B981' },
            { name: 'Click-through Rate', value: '8.7%', change: -2.3, color: '#F59E0B' },
            { name: 'Subscriber Growth', value: '+12.3K', change: 25.7, color: '#8B5CF6' },
            { name: 'Engagement Rate', value: '6.9%', change: 8.9, color: '#EF4444' }
        ],
        
        channelBreakdown: [
            {
                id: 'ch1',
                name: 'CryptoMaster Daily',
                subscribers: '67K',
                status: 'active',
                videos: 23,
                revenue: 2100,
                spend: 420,
                roi: 5.0
            },
            {
                id: 'ch2',
                name: 'AI Tools Review',
                subscribers: '34K',
                status: 'active',
                videos: 12,
                revenue: 1650,
                spend: 280,
                roi: 5.9
            },
            {
                id: 'ch3',
                name: 'Finance Genius',
                subscribers: '89K',
                status: 'paused',
                videos: 0,
                revenue: 0,
                spend: 0,
                roi: 0
            },
            {
                id: 'ch4',
                name: 'Mindset Mastery',
                subscribers: '156K',
                status: 'active',
                videos: 31,
                revenue: 3200,
                spend: 890,
                roi: 3.6
            },
            {
                id: 'ch5',
                name: 'Tech Trends Today',
                subscribers: '43K',
                status: 'active',
                videos: 47,
                revenue: 1970,
                spend: 860,
                roi: 2.3
            }
        ],
        
        formatCurrency(amount) {
            return '$' + amount.toLocaleString();
        },
        
        updateAnalytics() {
            // Simulate data update based on selected channel and time range
            console.log(`Updating analytics for ${this.selectedChannel} over ${this.timeRange}`);
        },
        
        exportData() {
            alert('Exporting analytics data...');
            // Would trigger CSV/Excel download
        },
        
        viewChannelDetails(channel) {
            alert(`Viewing detailed analytics for ${channel.name}`);
            // Would navigate to detailed channel analytics
        }
    }
}
</script>
{% endblock %}